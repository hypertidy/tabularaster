---
output: github_document
---

[![Travis-CI Build Status](https://travis-ci.org/r-gris/tabularaster.svg?branch=master)](https://travis-ci.org/r-gris/tabularaster)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/r-gris/tabularaster?branch=master&svg=true)](https://ci.appveyor.com/project/r-gris/tabularaster)
[![Coverage Status](https://img.shields.io/codecov/c/github/r-gris/tabularaster/master.svg)](https://codecov.io/github/r-gris/tabularaster?branch=master)

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# tabularaster

The `raster` package is extremely powerful in the R ecosystem for spatial data. It can be used very efficiently to 
drive data extraction and summary tools using its consistent cell-index and comprehensive helper functions for converting between cell values and less abstract raster grid properties. 

Tabularaster provides some more helpers for working with cells and tries to fill some of the (very few!) gaps in raster functionality. When raster returns cell values of hierarchical objects it returns a hierarchical (list) of cells to match the input query. 

Tabularaster provides: 

- extraction of cells as a simple data frame with "object ID" and "cell index"
- a "decimate" function for fast as possible resolution reduction
- workers to bring sf into the raster fold, WIP


there is some overlap with `quadmesh` and `spex` while I figure out where things belong


# Extract cells from rasters 

```{r}
library(tabularaster)
library(raster)
library(dplyr)
data("rastercano")
data("polycano")
cells <- cellnumbers(rastercano, polycano[4:5, ])


cellnumbers(rastercano, as(polycano[4:5, ], "SpatialLinesDataFrame"))
cellnumbers(rastercano, as(as(polycano[4:5, ], "SpatialLinesDataFrame"), "SpatialPointsDataFrame"))

## weights not workin
#xweight <- cellnumbers(rastercano, polycano[4:5, ], weights = TRUE)
#xweight  %>% group_by(object_)  %>% summarize(sum(weight_))

```

# Extract values or cell numbers with sf object

...



# Decimate

 It may be that `raster::aggregate` is better than `decimate`. 
 
```{r}
(r <- raster(volcano))
decimate(r, dec = 6)

(r2 <- disaggregate(r, fact = 25))
system.time(decimate(r2, 25))
```
